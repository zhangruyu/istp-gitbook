# 1. 竞品分析报告

## 1.1. 竞品信息

-   威努特.工控安全监测与审计系统.MA5612

-   六方云.工业审计系统 LinSec-A2000

-   绿盟.工控安全审计系统（SAS-ICSNX3-310A-C-NDE-02）

-   启明星辰.天阗工控安全监测与审计系统NT3000-ICS300-HD

-   长扬科技.工业监测审计系统INA-1000X-2F4E

## 1.2. 测试总览

针对威努特、六方云、启明星辰等5款工业安全审计竞品从以下8个维度展开了详细的测试，除资产主动识别外，均通过回放测试报文的方式进行测试。

-   资产被动识别：针对资产主动识别从厂商、系列、型号三个维度进行对比分析；

-   资产主动识别：针对资产被动识别从厂商、系列、型号三个维度进行对比分析；

-   协议识别：针对工业协议的识别从二层协议和应用层协议进行了对比分析；

-   **关键事件：针对关键事件从S7、Mosbus、CIP、IEC104、OPC_DA、MMS、DNP3、Profinet_DCP、FINS等26种不同协议的维度来对比分析；（其中13种协议为第二阶段测试内容）**

-   IPS-入侵检测：针对IPS-入侵检测从公开工控漏洞攻击、关键事件类攻击进行了对比分析**（第二阶段补充测试部分设备的IPS）**；

-   协议白名单和值域：针对协议白名单和值域分别从S7、Modbus、CIP、IEC104、OPC_DA、MMS、DNP3、Profinet_DCP、FINS等13种不同协议的维度来对比分析。

-   **畸形包检测：针对畸形包检测分别从CIP、DNP3、IEC104、MMS、Modbus_TCP、OPC_DA、S7、FINS
    TCP、BACnet、GOOSE、OPC_UA、SV等13种不同协议的维度来对比分析。（该维度为第二阶段测试内容）**

5款竞品各维度的测试结果以及对比分析详情将在章节3、4、5、6、7、8、9、10展开描述。

## 1.3. 资产被动识别功能

### 1.3.1. 测试范围

针对奇安信ISD及五款（启明星辰、六方云、威努特、长扬科技、绿盟）工业安全审计竞品分别进行资产被动识别测试，测试资产覆盖20个厂商62款设备。具体测试范围见下述列表。

| **测试范围** |                                             |
|--------------|---------------------------------------------|
| **厂商**     | **资产**                                    |
| ABB          | ABB.AC800F.PM802F                           |
|              | ABB.AC800M.PM856                            |
| Beckhoff     | Beckhoff.CX.CX1500-M310                     |
| BR           | BR.X20.CP1484                               |
| DCCE         | DCCE.MAC.MAC1000ProgramableController       |
| Etrol        | Etrol.RTU_PLC.Super32                       |
|              | Etrol.RTU.SuperE32L601                      |
| Fanuc        | Fanuc                                       |
| GE           | GE.VerMax_IC200CPUE05.Private               |
| HollySys     | HollySys.DCS.MACS                           |
|              | HollySys.NuclearPower.HEROS_RTS             |
|              | HollySys.NuclearPower.NB220                 |
|              | HollySys.NuclearPower.NM-DP                 |
|              | HollySys.NuclearPower.NM220                 |
|              | HollySys.PLC.LK220                          |
| HoneyWell    | Honey.Controller.C300                       |
|              | Honey.Firewall.FTE_Control_Firewall         |
| LT           | LT.GJ303.GHMSL                              |
| MITSUBISHI   | MITSUBISHI.LCPU.L06CPU                      |
|              | MITSUBISHI.QCPU.Q02HCPU                     |
|              | MITSUBISHI.QCPU.Q03UDECPU                   |
| MOXA         | MOXA.RemoteIO.E1242                         |
| NA           | NA.PLC.CPU401-0401                          |
| OMRON        | OMRON.CJ2M.CPU31                            |
|              | OMRON.CP.CP1H-XA40DT-D                      |
|              | OMRON.CP.CP1L-EL20DR-D                      |
| Phoenix      | Phoenix.100.ILC330ETH                       |
| RedLine      | redlion-crimson3_Crimson3                   |
| RockWell_AB  | RockWell_AB.CompactLogix_1769-L33ER         |
|              | RockWell_AB.ControlLogix_1756_EN2T_C        |
|              | RockWell_AB.ControlLogix_1756-EN2T_D        |
|              | RockWell_AB.ControlLogix_1756-EN2T_D\_CASIA |
| Schneider    | Schneider.M218_LADE40DRPHN                  |
|              | Schneider.M340_CPU340-20                    |
|              | Schneider.Quantum_CPU_31110                 |
|              | Schneider.Quantum_CPU_65150                 |
| Siemens      | Siemens.CP_343-1_advanced                   |
|              | Siemens.CP_343-1                            |
|              | Siemens.CP_443-1_advanced                   |
|              | Siemens.CP_443-1                            |
|              | Siemens.CP_1516-3                           |
|              | Siemens.CP_1543-1                           |
|              | Siemens.S7_200_Smart_CPU_st30               |
|              | Siemens.S7_200_Smart_CPU_st40               |
|              | Siemens.S7_200_Smart_CPU                    |
|              | Siemens.S7_300_CPU_314c-2_PNDP              |
|              | Siemens.S7_300_CPU_314c-2                   |
|              | Siemens.S7_300_CPU_315-2_PNDP               |
|              | Siemens.S7_300_CPU_315F-2                   |
|              | Siemens.S7_300_CPU_317-2_PNDP               |
|              | Siemens.S7_400_CPU_412-5h_PNDP              |
|              | Siemens.S7_400_CPU_412-5H                   |
|              | Siemens.S7_400_CPU_414-5h                   |
|              | Siemens.S7_1200_CPU_1212c_DCDCRly           |
|              | Siemens.S7_1200_CPU_1214C_ACDCRLY           |
|              | Siemens.S7_1200_CPU_1214c_DCDCDC            |
|              | Siemens.S7_1200_CPU_1215c_DCDCDC            |
|              | Siemens.S7-1500_CPU_1516-3_PNDP             |
|              | Siemens.SINUMERIK_808D                      |
| Supcon       | Supcon.GCS.GCS-3                            |
|              | Supcon.JX-300                               |
|              | Supcon.TCS-900                              |

### 1.3.2. 测试结果

| **产品**                                                | **资产被动识别** |            |            |              |
|---------------------------------------------------------|------------------|------------|------------|--------------|
|                                                         | **厂商**         | **系列**   | **型号**   | **识别数量** |
| **ISD**                                                 | **√**            | **√**      | **√**      | **14.26**    |
| **ISTP**                                                | **√**            | **√**      | **√**      | **20.62**    |
| **威努特.工控安全监测与审计系统.MA5612**                | **√**            |            | **√**      | **X.X**      |
| **六方云.工业审计系统 LinSec-A2000**                    | **√**            |            |            | **8.X**      |
| **绿盟.工控安全审计系统（SAS-ICSNX3-310A-C-NDE-02）**   | **√**            |            |            | **4.X**      |
| **启明星辰.天阗工控安全监测与审计系统NT3000-ICS300-HD** | **不支持**       | **不支持** | **不支持** |              |
| **长扬科技.工业监测审计系统INA-1000X-2F4E**             | **√**            | **　**     | **　**     | **1.X**      |

**奇安信ISD**：

-   具备资产被动识别功能（厂商/系列/型号）

-   可识别出14个厂商（除NA外），有26款设备可识别到型号

**六方云.工业审计系统 LinSec-A2000：**

-   具备资产被动识别功能（识别到厂商层面）

-   可实现8个厂商（西门子/施耐德/ ABB/罗克韦尔/ MOXA/三菱/欧姆龙/
    Honeywell）的识别

**长扬科技.工业监测审计系统INA-1000X-2F4E：**

-   与供应商确认，不支持资产识别

-   测试发现，产品界面有资产审计，但是仅识别出Siemens厂商，其他未识别

**绿盟.工控安全审计系统（SAS-ICSNX3-310A-C-NDE-02）：**

-   具备资产被动识别功能，学习到的资产以“设备类型_厂商_内核class类_序号（序号为
    1 2 N）”方式进行命名,并记录相应的IP或MAC,识别不到型号信息

-   可实现4个厂商（Siemens、Schneide、Rockwell、Omron）的识别

**威努特.工控安全监测与审计系统.MA5612**:

-   具有资产被动识别功能

-   测试时未实现，仅识别到IP、MAC层面，未识别到厂商及型号

**启明星辰.天阗工控安全监测与审计系统NT3000-ICS300-HD**：

-   产品不支持资产被动识别功能

### 1.3.3. 结论

基于上述测试结果，资产被动识别功能由强到弱，依次为：

1\. 奇安信ISD

2\. 六方云.工业审计系统 LinSec-A2000

3\. 绿盟.工控安全审计系统（SAS-ICSNX3-310A-C-NDE-02）

4\. 长扬科技.工业监测审计系统INA-1000X-2F4E

5\. 威努特.工控安全监测与审计系统.MA5612

6\. 启明星辰.天阗工控安全监测与审计系统NT3000-ICS300-HD

## 1.4. 资产主动识别功能

### 1.4.1. 测试范围

针对奇安信ISD及五款（启明星辰、六方云、威努特、长扬科技、绿盟）工业安全审计竞品分别进行资产主动识别测试，测试资产主要是西门子和施耐德2个厂商的2款PLC。

### 1.4.2. 测试结果

| **产品**                                                | **资产主动识别** |            |            |              |
|---------------------------------------------------------|------------------|------------|------------|--------------|
|                                                         | **厂商**         | **系列**   | **型号**   | **识别数量** |
| **ISD**                                                 | **√**            | **√**      | **√**      | **1.1**      |
| **ISTP**                                                | **√**            | **√**      | **√**      | **2.2**      |
| **威努特.工控安全监测与审计系统.MA5612**                | **不支持**       | **不支持** | **不支持** |              |
| **六方云.工业审计系统 LinSec-A2000**                    | **不支持**       | **不支持** | **不支持** |              |
| **绿盟.工控安全审计系统（SAS-ICSNX3-310A-C-NDE-02）**   | **不支持**       | **不支持** | **不支持** |              |
| **启明星辰.天阗工控安全监测与审计系统NT3000-ICS300-HD** | **不支持**       | **不支持** | **不支持** |              |
| **长扬科技.工业监测审计系统INA-1000X-2F4E**             | **不支持**       | **不支持** | **不支持** |              |

**奇安信ISD**：

-   具备资产主动识别功能（厂商/系列/型号），测试2个厂商的2个型号PLC设备，仅识别出一个设备

**六方云.工业审计系统、长扬科技.工业监测审计系统、绿盟.工控安全审计系统、威努特.工控安全监测与审计系统、启明星辰.天阗工控安全监测与审计系统**

-   以上厂商设备均不支持资产主动识别

**威努特.工控安全监测与审计系统**

-   仅内存32G及以上高配版本支持

### 1.4.3. 结论

基于上述测试结果，仅奇安信ISD支持资产主动识别功能，威努特.工控安全监测与审计系统.MA5612，仅内存32G及以上高配版本支持。资产主动识别功能由强到弱，依次为：

1.  奇安信ISD

2.  威努特.工控安全监测与审计系统.MA5612

3.  六方云.工业审计系统 LinSec-A2000；

4.  绿盟.工控安全审计系统（SAS-ICSNX3-310A-C-NDE-02）

5.  长扬科技.工业监测审计系统INA-1000X-2F4E；

6.  启明星辰.天阗工控安全监测与审计系统NT3000-ICS300-HD

## 1.5. 协议识别功能

### 1.5.1. 测试范围

针对启明星辰、六方云、威努特、长扬科技、绿盟等五款工业安全审计竞品分别进行协议识别测试，测试协议种类包含如下84种工业协议：

853协议、ATG、BACnet协议、Beckhoff_AMS_ADS、C37.118_1PMU_TCP、C37.118_1PMU_UDP、CIP协议、CoAP协议、DNP3、ENIP_UDP、ENIP协议、FF_FMS、FF_LR_UDP协议、FF_SM、Focas协议、GDW_376.1协议、GE_EGD协议、GE_SRTP协议、Gryphon、HartIP_TCP、HartIP_UDP、HL7、HollySys_DCS_MACS协议、HollySys_LK-UDP_6000、HollySys_PLC、HoneyWell、HoneyWell_FTE、HSRP、IEC103协议、IEC60870-5-104协议、IEC61850-GOOSE协议、IEC61850-MMS协议、IEC61850-SMV协议、ifix2ifix、ISAKMP、Lantronix、MITSUBISHI
MELSEC_Q\_UDP、MITSUBISHI_MELSEC_L\_TCP、Modbus_ASCII、Modbus_RTU、Modbus_TCP、Modbus_UDP、Modbus_UMAS、MOXA_E1242_UDP、MQTT
V3/V4、MQTT
V5、Omron_FINS_TCP协议、Omron_FINS_UDP协议、OPC_DA协议、OPC_UA协议、OpenSafety_UDP、Ovation、PCWORX、PHONENIX_CONTACT、PowerLink_UDP、Redlion_Crimson3、RSSP_1协议、SchneiderFoxboro_IA、Siemens_Profinet_DCP、Siemens_Profinet_IO_CM、Siemens_Profinet_MRP、Siemens_S5、Siemens_Profinet_PTCP、Siemens_S7、Siemens_S7Plus、SinecH1、Supcon_JX300、Tridium_Niagara_Fox、Wago_CoDeSys、ZigBee_UDP、安控_sl304、步科Kinco、大工计控、丹东华通_2000R、昆仑通态
MCGS、力控实时数据库、南大傲拓、南大奥拓_NA-RTU、上海新华DCS
TCP、松下Panasonic、上海新华DCS协议 UDP、研华Advantech、易控、中自DCS、

### 1.5.2. 测试结果

| **产品**                                                | **协议识别**     |                      |                                                                       |
|---------------------------------------------------------|------------------|----------------------|-----------------------------------------------------------------------|
|                                                         | **测试协议数量** | **预置工业协议数量** | **备注**                                                              |
| **ISTP**                                                | **84**           | **84**               |                                                                       |
| **威努特.工控安全监测与审计系统.MA5612**                | **13**           | **13**               | 威努特无特定的协议识别功能，其支持工业白名单功能支持13种工业协议      |
| **六方云.工业审计系统 LinSec-A2000**                    | **16**           | **48**               | 不支持二层协议识别                                                    |
| **绿盟.工控安全审计系统（SAS-ICSNX3-310A-C-NDE-02）**   | **16**           | **31**               | 支持二层协议识别                                                      |
| **启明星辰.天阗工控安全监测与审计系统NT3000-ICS300-HD** |                  | **4**                | 启明星辰无特定的协议识别功能，其支持入侵检测中包含4种工业协议相关规则 |
| **长扬科技.工业监测审计系统INA-1000X-2F4E**             | **10**           | **11**               | 不支持二层协议识别                                                    |

**奇安信ISTP**：

-   支持84种工业协议的识别，

-   支持二层协议和应用层协议

**六方云.工业审计系统 LinSec-A2000：**

-   设备预置支持工业协议支持48种；其中32种协议有对应的测试报文，测试仅支持16种（其中OPTO协议识别出现误报）

-   仅支持应用层协议，不支持二层协议

**长扬科技.工业监测审计系统INA-1000X-2F4E：**

-   设备预置支持工业协议支持11种；其中10种协议有对应的测试报文，测试支持10种（其中ENIP-IO协议识别存在疑问）

-   仅支持应用层协议，不支持二层协议

-   针对DNP3协议不支持只有data link layer的数据包

**绿盟.工控安全审计系统（SAS-ICSNX3-310A-C-NDE-02）：**

-   设备预置支持工业协议支持31种；其中25种协议有对应的测试报文，测试仅支持16种（其中Profinet-rpc协议识别存在疑问）

-   支持二层协议和应用层协议

**威努特.工控安全监测与审计系统.MA5612**:

-   威努特无特定的协议识别功能，其支持工业白名单功能支持13种工业协议

-   针对MMS协议不能识别不带COTP的报文，也不支持仅请求带有COTP但响应不带COTP的报文

**启明星辰.天阗工控安全监测与审计系统NT3000-ICS300-HD**：

-   启明星辰无特定的协议识别功能，其入侵检测功能中包含4种工业协议相关规则

### 1.5.3. 结论

基于上述测试结果，依据支持协议种类数评估竞品的协议识别功能，由强到弱依次为：

1\. 奇安信ISTP

2\. 六方云.工业审计系统 LinSec-A2000

3\. 绿盟.工控安全审计系统（SAS-ICSNX3-310A-C-NDE-02）

4\. 长扬科技.工业监测审计系统INA-1000X-2F4E

5\. 威努特.工控安全监测与审计系统.MA5612

6\. 启明星辰.天阗工控安全监测与审计系统NT3000-ICS300-HD

## 1.6. 关键事件功能

### 1.6.1. 测试范围

针对启明星辰、六方云、威努特、长扬科技、绿盟等5款工业安全审计竞品分别进行关键事件测试，关键事件测试用例覆盖了13个厂商的设备以及26种协议

| 类型 | 厂商/协议             | 测试范围                                            |
|------|-----------------------|-----------------------------------------------------|
| 厂商 | Siemens               | 包含PLC停止、PLC启动、设置时钟、暖启动等关键事件    |
|      | Schneider             | 包含启动PLC、停止PLC、开始下装、结束下装等关键事件  |
|      | Rockwell              | 包含删除、恢复、设置成员、设置多有属性等关键事件    |
|      | Omron                 | 包含运行、停止、文件删除、拷贝文件等关键事件        |
|      | ABB                   | 包含写操作、输入、输出、重命名、开始等关键事件      |
|      | **GE**                | 包含停止PLC、启动PLC、下载等关键事件                |
|      | **MITSUBISHI**        | 包含RUN、Stop、Pause、RESET等关键事件               |
|      | **Fanuc**             | 包含启动、建立连接、停止等关键事件                  |
|      | **Hollysys**          | 包含停止、运行、下载等关键事件                      |
|      | **上海新华**          | 包含上装、改密码、清空组态、复位控制器等关键事件    |
|      | **安控**              | 包含井口配置、RTU配置、开机、关机等关键事件         |
|      | **丹东华通**          | 包含油井启动、油井停止、加热炉燃烧器关断等关键事件  |
|      | **南大傲拓**          | 包含复位、关闭进程、关闭看门狗等关键事件            |
| 协议 | S7                    | 包含PLC停止、PLC启动、设置时钟、暖启动等关键事件    |
|      | Mosbus_TCP            | 包含写单线圈、写多个线圈、写单个寄存器等关键事件    |
|      | Modbus_UMAS           | 包含启动PLC、停止PLC、开始下装、结束下装等关键事件  |
|      | CIP_COMM              | 包含删除、恢复、PLC停止等关键事件                   |
|      | CIP_PCCC              | 包含重启、上载、下装等关键事件                      |
|      | CIP_Logix5000         | 包含写数据等关键事件                                |
|      | IEC104                | 包含单命令、双命令、重置进程命令关键事件            |
|      | OPC_DA                | 包含IOPCSyncIO Write、IOPCItemIO WriteVQT等关键事件 |
|      | MMS                   | 包含写操作、输入、输出、重命名、开始等关键事件      |
|      | DNP3                  | 包含写操作、冷再启动、暖再启动、保存组态等关键事件  |
|      | FINS_TCP              | 包含运行、停止、置位、清空PLC等关键事件             |
|      | FINS_UDP              | 包含运行、停止、置位、清空PLC等关键事件             |
|      | **Profinet_DCP**      | 包含设置IP等关键事件                                |
|      | **profinet-MRP**      | 包含Link Down、Link UP、Test等关键事件              |
|      | **profinet-MRRT**     | 包含Common、Test等关键事件                          |
|      | **profinet-PTCP**     | 包含Subdomain、Master、Port Parameter等关键事件     |
|      | **GE-SRTP**           | 包含停止PLC、启动PLC、下载等关键事件                |
|      | **MITSUBISHI**        | 包含RUN、Stop、Pause、RESET等关键事件               |
|      | **安控_SL304**        | 包含井口配置、RTU配置、开机、关机等关键事件         |
|      | **丹东华通.2000R_CS** | 包含油井启动、油井停止、加热炉燃烧器关断等关键事件  |
|      | **南大傲拓.NA-RTU**   | 包含复位、关闭进程、关闭看门狗等关键事件            |
|      | **Fanuc-focas**       | 包含启动、建立连接、停止等关键事件                  |
|      | **HollySys**          | 包含停止、运行、下载等关键事件                      |
|      | **Electricity**       | 包含Reset等关键事件                                 |
|      | **上海新华_DCS**      | 包含上装、改密码、清空组态、复位控制器等关键事件    |
|      | **BACnet**            | 包含File Access、Remote Device Management等关键事件 |
|      | **GOOSE**             | 包含检修状态等关键事件                              |
|      | **RSSP-1**            | 包含时序校正请求等关键事件                          |
|      | **OPC_UA**            | 包含添加节点、删除节点、删除参考等关键事件          |

### 1.6.2. 测试结果

| **协议名称**          | **ISTP** | **威努特** | **六方云**   |              | **绿盟**     |              | **启明星辰** |              | **长扬科技** |
|-----------------------|----------|------------|--------------|--------------|--------------|--------------|--------------|--------------|--------------|
|                       |          |            | **触发数量** | **预置数量** | **触发数量** | **预置数量** | **触发数量** | **预置数量** |              |
| **S7**                | 22       | 9          | 10           | 11           | 10           | 11           | 0            | 0            | 不支持       |
| **CIP COMM**          | 16       | 13         | 0            | 0            | 5            | 8            | 5            | 7            | 不支持       |
| **CIP Logix5000**     | 0        | 2          | 0            | 0            | 0            | 0            | 0            | 0            | 不支持       |
| **CIP PCCC**          | 0        | 34         | 0            | 0            | 17           | 20           | 0            | 0            | 不支持       |
| **FINS_TCP**          | 7        | 29         | 0            | 0            | 0            | 0            | 0            | 0            | 不支持       |
| **FINS_UDP**          | 7        | 17         | 0            | 0            | 0            | 0            | 0            | 0            | 不支持       |
| **Modbus TCP**        | 4        | 4          | 4            | 4            | 6            | 6            | 7            | 7            | 不支持       |
| **Modbus UMAS**       | 9        | 0          | 3            | 8            | 0            | 6            | 0            | 0            | 不支持       |
| **OPC_DA**            | 8        | 5          | 0            | 0            | 7            | 7            | 0            | 0            | 不支持       |
| **MMS**               | 49       | 1          | 0            | 0            | 0            | 6            | 0            | 0            | 不支持       |
| **IEC104**            | 15       | 14         | 0            | 0            | 4            | 4            | 2            | 2            | 不支持       |
| **DNP3**              | 5        | 30         | 0            | 0            | 23           | 23           | 0            | 0            | 不支持       |
| **Profinet-DCP**      | 1        | 0          | 0            | 0            | 0            | 0            | 0            | 4            | 不支持       |
| **Profinet-MRP**      | 6        | 0          | 0            | 0            | 0            | 0            | 0            | 0            | 不支持       |
| **Profinet-MRRT**     | 3        | 0          | 0            | 0            | 0            | 0            | 0            | 0            | 不支持       |
| **Profinet-PTCP**     | 10       | 0          | 0            | 0            | 0            | 0            | 0            | 0            | 不支持       |
| **GE-SRTP**           | 1        | 0          | 11           | 17           | 0            | 0            | 0            | 0            | 不支持       |
| **MITSUBISHI**        | 0        | 0          | 0            | 0            | 0            | 10           | 0            | 0            | 不支持       |
| **安控_SL304**        | 6        | 0          | 0            | 0            | 0            | 0            | 0            | 0            | 不支持       |
| **丹东华通.2000R_CS** | 9        | 0          | 0            | 0            | 0            | 0            | 0            | 0            | 不支持       |
| **南大傲拓.NA-RTU**   | 10       | 0          | 0            | 0            | 0            | 0            | 0            | 0            | 不支持       |
| **Fanuc-focas**       | 3        | 0          | 0            | 0            | 0            | 0            | 0            | 0            | 不支持       |
| **HollySys**          | 0        | 0          | 0            | 13           | 0            | 51           | 0            | 0            | 不支持       |
| **Electricity**       | 0        | 0          | 0            | 0            | 0            | 0            | 0            | 0            | 不支持       |
| **上海新华_DCS**      | 4        | 0          | 0            | 0            | 0            | 0            | 0            | 0            | 不支持       |
| **BACnet**            | 0        | 0          | 0            | 0            | 0            | 7            | 0            | 0            | 不支持       |
| **GOOSE**             | 1        | 0          | 0            | 0            | 0            | 0            | 0            | 0            | 不支持       |
| **RSSP-1**            | 1        | 0          | 0            | 0            | 0            | 0            | 0            | 0            | 不支持       |
| **OPC_UA**            | 30       | 0          | 0            | 0            | 0            | 0            | 0            | 0            | 不支持       |
| 协议数量总计          | 23       | 11         | 4            | 5            | 7            | 12           | 3            | 4            | 0            |
| 关键事件数量总计      | 227      | 158        | 28           | 53           | 72           | 159          | 14           | 20           | 0            |

**奇安信ISTP：**

-   支持以设备和协议为基础进行关键事件检测

-   支持11个厂商（Siemens、Schneider、Rockwell、Omron、ABB、GE、Fanuc、上海新华、安控、丹东华通、南大傲拓）

-   支持23种协议（S7、CIP COMM、FINS_TCP、FINS_UDP、Modbus TCP、Modbus
    UMAS、OPC_DA、MMS、IEC104、DNP3、Profinet-DCP、Profinet-MRP、Profinet-MRRT、Profinet-PTCP、GE-SRTP、安控_SL304、丹东华通.2000R_CS、南大傲拓.NA-RTU、Fanuc-focas、上海新华_DCS、GOOSE、RSSP-1、OPC_UA）

-   支持关键事件227条

**威努特.工控安全监测与审计系统.MA5612:**

-   支持以协议为基础进行关键事件检测

-   支持11种协议（S7、Modbus_TCP、CIP_Logix5000、CIP_PCCC、CIP_COMM、FINS_TCP、FINS_UDP、OPC_DA、MMS、IEC104、DNP3）

-   支持关键事件158条

**六方云.工业审计系统 LinSec-A2000：**

-   该产品没有明确关键事件功能，但可以敏感操作来体现关键事件，本次依据敏感操作功能进行关键事件测试，支持以协议为基础进行关键事件检测

-   支持5种协议（S7、Modbus_TCP、Modbus_UMAS、GE-SRTP、HollySys）

-   支持关键事件53条

**绿盟.工控安全审计系统（SAS-ICSNX3-310A-C-NDE-02）：**

-   该产品没有明确关键事件功能，但可以黑名单告警来体现关键事件，本次依据黑名单告警功能进行关键事件测试，支持以协议为基础进行关键事件检测

-   支持12种协议（S7、CIP COMM、CIP
    PCCC、Modbus_TCP、Modbus_UMAS、OPC_DA、MMS、IEC104、DNP3、MITSUBISHI、HollySys、BACnet）

-   支持关键事件159条

**启明星辰.天阗工控安全监测与审计系统NT3000-ICS300-HD：**

-   该产品没有明确关键事件功能，但可以黑名单告警来体现关键事件，本次依据敏感操作功能进行关键事件测试，支持以协议为基础进行关键事件检测。

-   支持4种协议（CIP COMM、Modbus TCP、IEC104、Profinet-DCP）

-   支持关键事件20条

**长扬科技.工业监测审计系统INA-1000X-2F4E：**

-   产品不支持关键事件功能

### 1.6.3. 结论

基于上述测试结果，依据支持协议类型以及关键事件数量评估关键事件检测功能，由强到弱依次为：

1\. 威努特.工控安全监测与审计系统.MA5612

2\. 奇安信ISTP

3\. 绿盟.工控安全审计系统（SAS-ICSNX3-310A-C-NDE-02）

4\. 六方云.工业审计系统 LinSec-A2000

5\. 启明星辰.天阗工控安全监测与审计系统NT3000-ICS300-HD

6\. 长扬科技.工业监测审计系统INA-1000X-2F4E

## 1.7. IPS-入侵检测功能

### 1.7.1. 测试范围

针对启明星辰、六方云、威努特、长扬科技、绿盟等五款工业安全审计竞品分别进行IPS入侵检测测试，测试入侵检测所涉及的漏洞或攻击包含如下几方面：

> 公开工控漏洞攻击：53
>
> 补天工控漏洞攻击：96
>
> 原创工控漏洞攻击：27
>
> 工控关键事件类攻击：48
>
> 工控其他类攻击：166

### 1.7.2. 测试结果

<table>
<colgroup>
<col style="width: 20%" />
<col style="width: 17%" />
<col style="width: 18%" />
<col style="width: 44%" />
</colgroup>
<thead>
<tr class="header">
<th rowspan="2"><strong>产品</strong></th>
<th colspan="3"><strong>IPS</strong></th>
</tr>
<tr class="odd">
<th><strong>测试IPS告警数量</strong></th>
<th><strong>预置IPS规则数量</strong></th>
<th><strong>备注</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>ISTP</strong></td>
<td><strong>90</strong></td>
<td><strong>180</strong></td>
<td>测试IPS告警数量为产品ISD\防火墙支持的规则数量</td>
</tr>
<tr class="even">
<td><strong>威努特.工控安全监测与审计系统.MA5612</strong></td>
<td><strong>不支持</strong></td>
<td><strong>不支持</strong></td>
<td>无IPS功能</td>
</tr>
<tr class="odd">
<td><strong>六方云.工业审计系统 LinSec-A2000</strong></td>
<td><strong>21/23（10+11）</strong></td>
<td><strong>394/4062</strong></td>
<td>上报的入侵事件告警中包含21个工业相关入侵规则，其中包含10个恶意攻击、11个敏感操作（关键事件）；另外2个均为IT相关入侵规则</td>
</tr>
<tr class="even">
<td><strong>绿盟.工控安全审计系统（SAS-ICSNX3-310A-C-NDE-02）</strong></td>
<td><strong>27/39（6+21）</strong></td>
<td><strong>108/4681</strong></td>
<td>上报的入侵事件告警中包含27个工业相关入侵规则，其中包含6个恶意攻击，21个敏感操作-关键事件；另外12个均为IT相关入侵规则</td>
</tr>
<tr class="odd">
<td><strong>启明星辰.天阗工控安全监测与审计系统NT3000-ICS300-HD</strong></td>
<td><p><strong>13/24</strong></p>
<p><strong>（2+11）</strong></p></td>
<td><strong>104/5082</strong></td>
<td>上报的入侵事件告警中包含13个工业相关入侵规则，其中包含2个恶意攻击，11个敏感操作-关键事件；另外11个均为IT相关入侵规则</td>
</tr>
<tr class="even">
<td><strong>长扬科技.工业监测审计系统INA-1000X-2F4E</strong></td>
<td><strong>6/9</strong></td>
<td><strong>181/985</strong></td>
<td>上报的入侵事件告警中包含6个工业相关入侵规则，另外包含2个DDOS告警（DDOS
UDP FLOOD和DDOS SYNC FLOOD）和1个端口扫描告警</td>
</tr>
</tbody>
</table>

**奇安信ISTP**：

-   目前产品ISD\防火墙支持的工业IPS规则数量为90，均为ISTP提供，目前ISTP已有工业IPS规则约180条

**六方云.工业审计系统 LinSec-A2000：**

-   预置IPS规则有4062条，其中工控相关规则394条

-   测试可检测出21个工业相关入侵规则告警，其中包含10个恶意攻击、11个敏感操作（关键事件）

**长扬科技.工业监测审计系统INA-1000X-2F4E：**

-   预置IPS规则985条，其中工控相关规则181条

-   测试可检测出6个工业相关入侵规则告警，另外还可以检测中2个DDOS告警（DDOS
    UDP FLOOD和DDOS SYNC FLOOD）和1个端口扫描告警

**绿盟.工控安全审计系统（SAS-ICSNX3-310A-C-NDE-02）：**

-   预置IPS规则4681条，其中工控相关规则108条

-   测试可检测出27个工业相关入侵规则，其中包含6个恶意攻击，21个敏感操作-关键事件；另外12个均为IT相关入侵规则

**威努特.工控安全监测与审计系统.MA5612**:

-   不支持

**启明星辰.天阗工控安全监测与审计系统NT3000-ICS300-HD**：

-   预置IPS规则5082条，其中工控相关规则104条

-   测试可检测出13个工业相关入侵规则，其中包含2个恶意攻击，11个敏感操作-关键事件；另外11个均为IT相关入侵规则

### 1.7.3. 结论

基于上述测试结果，依据支持工业IPS规则数量和测试结果评估竞品的IPS功能，由强到弱依次为：

1.  奇安信ISTP

2.  六方云.工业审计系统 LinSec-A2000

3.  绿盟.工控安全审计系统（SAS-ICSNX3-310A-C-NDE-02）

4.  启明星辰.天阗工控安全监测与审计系统NT3000-ICS300-HD

5.  长扬科技.工业监测审计系统INA-1000X-2F4E

6.  威努特.工控安全监测与审计系统.MA5612

## 1.8. 协议白名单功能

### 1.8.1. 测试范围

针对启明星辰、六方云、威努特、长扬科技、绿盟等5款工业安全审计竞品分别进行协议白名单测试，测试范围涉及如下14种协议：S7、Mosbus_TCP、Modbus_UMAS、CIP_COMM、CIP_PCCC、CIP_Logix5000、IEC104、OPC_DA、MMS、DNP3、Profinet_DCP、FINS_TCP、FINS_UDP、Profinet
DCP；针对每个协议以功能码为单位来筛选部分测试用例进行测试。

### 1.8.2. 测试结果

<img src="./media/image1.png"
style="width:6.72153in;height:2.21597in" />

**奇安信ISTP**：

-   支持14种协议的白名单检测

-   无三次握手流量：支持

**六方云.工业审计系统 LinSec-A2000：**

-   支持10种协议的白名单学习和检测

-   无三次握手流量：不支持

**长扬科技.工业监测审计系统INA-1000X-2F4E：**

-   支持9种协议的白名单学习和检测

-   无三次握手流量：支持

**绿盟.工控安全审计系统（SAS-ICSNX3-310A-C-NDE-02）：**

-   支持8种协议的白名单学习和检测

-   无三次握手流量：不支持

**威努特.工控安全监测与审计系统.MA5612**:

-   支持12种协议的白名单学习和检测

-   无三次握手流量：支持

**启明星辰.天阗工控安全监测与审计系统NT3000-ICS300-HD**：

-   不支持白名单学习功能，仅能通过指定协议字段范围来检测告警

-   无三次握手流量：不支持

### 1.8.3. 结论

根据支持协议的功能码以及解析字段评估竞品的协议白名单功能，由强到弱依次为：

1.  奇安信ISTP

2.  威努特.工控安全监测与审计系统.MA5612

3.  六方云.工业审计系统 LinSec-A2000

4.  长扬科技.工业监测审计系统INA-1000X-2F4E

5.  绿盟.工控安全审计系统（SAS-ICSNX3-310A-C-NDE-02）

> 其中，启明星辰.天阗工控安全监测与审计系统NT3000-ICS300-HD由于没有白名单功能，没有参与测试

## 1.9. 协议值域功能

### 1.9.1. 测试范围

针对启明星辰、六方云、威努特、长扬科技、绿盟等5款工业安全审计竞品分别进行协议白名单-值域执行情况测试，测试范围涉及如下14种协议：S7、Mosbus_TCP、Modbus_UMAS、CIP_COMM、CIP_PCCC、CIP_Logix5000、IEC104、OPC_DA、MMS、DNP3、Profinet_DCP、FINS_TCP、FINS_UDP、Profinet
DCP；针对每个协议以功能码为单位来筛选部分测试用例进行测试。

### 1.9.2. 测试结果

<img src="./media/image2.png"
style="width:4.93735in;height:3.24738in" />

**奇安信ISTP**：

-   支持2种协议的值域白名单检测

**六方云.工业审计系统 LinSec-A2000：**

-   不支持

**长扬科技.工业监测审计系统INA-1000X-2F4E：**

-   不支持

**绿盟.工控安全审计系统（SAS-ICSNX3-310A-C-NDE-02）：**

-   不支持

**威努特.工控安全监测与审计系统.MA5612**:

-   页面显示支持3种协议的值域白名单检测，但是测试发现并不能学习到值域规则，且不会产生对应的告警

**启明星辰.天阗工控安全监测与审计系统NT3000-ICS300-HD**

-   不支持

### 1.9.3. 结论

根据支持值域的协议数量评估竞品的值域功能，（因威努特设备的测试结果和页面显示不一致，不考虑测试结果），由强到弱依次为：

1.  威努特.工控安全监测与审计系统.MA5612

2.  奇安信ISTP

3.  绿盟.工控安全审计系统（SAS-ICSNX3-310A-C-NDE-02）

4.  六方云.工业审计系统 LinSec-A2000

5.  长扬科技.工业监测审计系统INA-1000X-2F4E

其中，启明星辰.天阗工控安全监测与审计系统NT3000-ICS300-HD由于没有白名单功能，没有参与测试

## 1.10. 畸形包检测功能

### 1.10.1. 测试范围

针对启明星辰、六方云、威努特、长扬科技、绿盟等5款工业安全审计竞品分别进行畸形包检测测试，测试范围涉及如下13种协议：CIP、DNP3、IEC104、MMS、Modbus_TCP、Modbus_UMAS、OPC_DA、S7、Omron
FINS
TCP、BACnet、GOOSE、OPC_UA、SV；针对每个协议以校验字段为单位来筛选部分测试用例进行测试。

### 1.10.2. 测试结果

| **协议名称**       | **畸形包检测支持情况** |            |            |          |              |              |
|--------------------|------------------------|------------|------------|----------|--------------|--------------|
|                    | **ISTP**               | **威努特** | **六方云** | **绿盟** | **启明星辰** | **长扬科技** |
| **CIP**            | √                      | √          |            | 不支持   | √            | 不支持       |
| **DNP3**           | √                      | √          |            | 不支持   |              | 不支持       |
| **IEC104**         | √                      | √          | √          | 不支持   | √            | 不支持       |
| **MMS**            | √                      | √          |            | 不支持   |              | 不支持       |
| **Modbus_TCP**     | √                      | √          | √          | 不支持   | √            | 不支持       |
| **Modbus_UMAS**    | √                      |            |            | 不支持   |              | 不支持       |
| **OPC_DA**         | √                      | √          |            | 不支持   |              | 不支持       |
| **S7**             | √                      | √          | √          | 不支持   |              | 不支持       |
| **Omron FINS TCP** | √                      |            |            | 不支持   |              | 不支持       |
| **BACnet**         | √                      |            |            | 不支持   |              | 不支持       |
| **GOOSE**          | √                      |            |            | 不支持   |              | 不支持       |
| **OPC_UA**         | √                      |            |            | 不支持   |              | 不支持       |
| **SV**             | √                      |            |            | 不支持   |              | 不支持       |
| **支持协议数**     | 13                     | 7          | 3          | 0        | 3            | 0            |

**奇安信ISTP：**

-   支持13种协议的畸形包检测，包含CIP、DNP3、IEC104、MMS、Modbus_TCP、Modbus_UMAS、OPC_DA、S7、Omron
    FINS TCP、BACnet、GOOSE、OPC_UA、SV等协议

-   不同协议支持多个字段的畸形校验

-   上报的日志信息中包含详细的畸形、规约异常信息

**威努特.工控安全监测与审计系统.MA5612：**

-   支持7种协议的畸形包检测，包含CIP、DNP3、IEC104、MMS、Modbus_TCP、OPC_DA、S7等协议

-   不同协议支持多个字段的畸形校验，例如：长度、version、function
    code、UUID等字段

-   上报的日志信息中不包含异常信息，仅上报工业规约告警

**启明星辰.天阗工控安全监测与审计系统NT3000-ICS300-HD：**

-   支持3种协议的畸形包检测（以入侵检测的形式表现），包含CIP、IEC104、Modbus_TCP等协议

-   每个协议支持的字段较单一，例如：CIP-状态码、IEC-控制域和长度、Modbus-异常码等字段

-   上报的日志信息中包含异常信息

**六方云.工业审计系统 LinSec-A2000：**

-   支持3种协议的畸形包检测，包含IEC104、Modbus_TCP、S7等协议

-   每个协议支持的字段较单一，例如：IEC104-长度、Modbus-CRC、S7-pdu_type

-   上报的日志信息中包含异常信息

**长扬科技.工业监测审计系统INA-1000X-2F4E：**

-   不支持

**绿盟.工控安全审计系统（SAS-ICSNX3-310A-C-NDE-02）：**

-   不支持

### 1.10.3. 结论

根据支持的协议数、校验字段数以及告警信息评估竞品的畸形包检测功能，由强到弱依次为：

1.  奇安信ISTP

2.  威努特.工控安全监测与审计系统.MA5612

3.  六方云.工业审计系统 LinSec-A2000

4.  启明星辰.天阗工控安全监测与审计系统NT3000-ICS300-HD

5.  绿盟.工控安全审计系统（SAS-ICSNX3-310A-C-NDE-02）

> 长扬科技.工业监测审计系统INA-1000X-2F4E

## 1.11. 总结

| **产品**        | **资产-主**    | **资产-被**        | **协议识别** | **关键事件**     | **IPS**  | **DPI** | **畸形** |
|-----------------|----------------|--------------------|--------------|------------------|----------|---------|----------|
| **奇安信.ISD**  | 1.1/2.2        | 14.26/20.62        |              | 13.150/26        |          | 14/16   | 6/13     |
| **奇安信ISTP**  | 2.2/2.2        | 20.62/20.62        | 84/84        | 23.227/26        | 180/180  | 14/16   | 13/13    |
| **威努特.审计** | 采购版本不支持 | 有此功能，但未实现 | 13/13        | 11.158/11.158/26 | 不支持   | 12/16   | 8/13     |
| **长扬.审计**   | 不支持         | 1.X/20.62          | 11/20        | 不支持           | 181/985  | 11/16   | 0/13     |
| **六方云.审计** | 不支持         | 8.X/20.62          | 48/48        | 4.28/5.53/26     | 394/4062 | 10/16   | 3/13     |
| **绿盟.审计**   | 不支持         | 4.X/20.62          | 31/116       | 7.72/12.159/26   | 108/4681 | 9/16    | 0/13     |
| **启明.审计**   | 不支持         | 不支持             | 4/36         | 3.14/4.20/26     | 104/5082 | 不支持  | 3/13     |

备注：

资产识别：8.X/20.62：识别8个厂家.不支持型号/总共20个厂家.62个型号

协议识别：工控协议/所有协议

关键事件：支持协议数.关键事件用例/协议数

IPS：工控漏洞/整理漏洞

畸形：支持协议数量/测试协议数量

竞品测试的第一阶段和第二阶段针对威努特、六方云、启明星辰等5款竞品（工业审计）从资产主动识别、资产被动识别、协议识别、关键事件、白名单、畸形包检测等8个维度展开了测试和分析，目前已完成竞品分析的第二阶段，针对报告中的数据做如下说明：

1、本阶段分析的对象除5款竞品以外，还包含产品ISD，因时间原因本阶段对ISD的畸形包检测和关键事件功能模块进行了测试分析。

2、因第一阶段启明星辰审计设备的自身问题导致设备不可用（中间返厂修复，问题原因：多次断电重启会造成设备文件丢失），因此本阶段补充测试了该设备的IPS、关键事件、畸形包检测等功能。
因第一阶段未完成六方云预置规则库分类，因此本阶段针对该设备的预置工控规则进行了筛选分类。

4、因第一阶段仅测试了13种协议的关键事件，在第二阶段针对关键事件尽量扩展测试，完成了26种协议相关关键事件测试（这里的测试用例集包含设备关键操作采集报文和协议全量功能码测试报文），并针对ISTP与竞品之间的差距进行了细化，转化为部分需求。

5、本阶段针对5款竞品进行了畸形包检测功能的对比分析，其中因威努特对于畸形包检测的告警不包含异常信息，仅上报工业规约告警，在测试过程中仅抽取了部分字段进行了测试对比，另外对于六方云、启明星辰、绿盟、长扬科技均进行了畸形包检测的全量测试。
